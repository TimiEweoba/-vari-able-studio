{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Desktop/Work/veri-able/-vari-able-studio/shared/schema.ts"],"sourcesContent":["import { sql } from \"drizzle-orm\";\r\nimport { pgTable, text, varchar } from \"drizzle-orm/pg-core\";\r\nimport { createInsertSchema } from \"drizzle-zod\";\r\nimport { z } from \"zod\";\r\n\r\nexport const users = pgTable(\"users\", {\r\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\r\n  username: text(\"username\").notNull().unique(),\r\n  password: text(\"password\").notNull(),\r\n});\r\n\r\nexport const contactRequests = pgTable(\"contact_requests\", {\r\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\r\n  name: text(\"name\").notNull(),\r\n  email: text(\"email\").notNull(),\r\n  company: text(\"company\"),\r\n  message: text(\"message\").notNull(),\r\n  createdAt: text(\"created_at\").default(sql`CURRENT_TIMESTAMP`),\r\n});\r\n\r\nexport const projects = pgTable(\"projects\", {\r\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\r\n  title: text(\"title\").notNull(),\r\n  description: text(\"description\").notNull(),\r\n  category: text(\"category\").notNull(),\r\n  imageUrl: text(\"image_url\").notNull(),\r\n  link: text(\"link\"),\r\n  featured: text(\"featured\").default(\"false\"), // \"true\" or \"false\"\r\n});\r\n\r\nexport const payments = pgTable(\"payments\", {\r\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\r\n  txRef: text(\"tx_ref\").notNull().unique(),\r\n  email: text(\"email\").notNull(),\r\n  amount: text(\"amount\").notNull(),\r\n  currency: text(\"currency\").notNull(),\r\n  status: text(\"status\").notNull().default(\"pending\"),\r\n  data: text(\"data\"), // store full payload if needed\r\n  createdAt: text(\"created_at\").default(sql`CURRENT_TIMESTAMP`),\r\n});\r\n\r\nexport const insertUserSchema = createInsertSchema(users).pick({\r\n  username: true,\r\n  password: true,\r\n});\r\n\r\nexport const insertContactSchema = createInsertSchema(contactRequests).omit({\r\n  id: true,\r\n  createdAt: true,\r\n}).extend({\r\n  name: z.string().min(2, \"Name must be at least 2 characters\"),\r\n  email: z.string().email(\"Please enter a valid email address\"),\r\n  message: z.string().min(10, \"Message must be at least 10 characters\"),\r\n});\r\n\r\nexport const insertProjectSchema = createInsertSchema(projects).omit({\r\n  id: true,\r\n});\r\n\r\nexport type InsertUser = z.infer<typeof insertUserSchema>;\r\nexport type User = typeof users.$inferSelect;\r\n\r\nexport type InsertContactRequest = z.infer<typeof insertContactSchema>;\r\nexport type ContactRequest = typeof contactRequests.$inferSelect;\r\n\r\nexport type InsertProject = z.infer<typeof insertProjectSchema>;\r\nexport type Project = typeof projects.$inferSelect;\r\n\r\nexport const insertPaymentSchema = createInsertSchema(payments).omit({\r\n  id: true,\r\n  createdAt: true,\r\n});\r\n\r\nexport type InsertPayment = z.infer<typeof insertPaymentSchema>;\r\nexport type Payment = typeof payments.$inferSelect;\r\n\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AACA;AAAA;AAAA;AACA;AACA;;;;;AAEO,MAAM,QAAQ,IAAA,kKAAO,EAAC,SAAS;IACpC,IAAI,IAAA,+KAAO,EAAC,MAAM,UAAU,GAAG,OAAO,CAAC,qJAAG,CAAC,iBAAiB,CAAC;IAC7D,UAAU,IAAA,yKAAI,EAAC,YAAY,OAAO,GAAG,MAAM;IAC3C,UAAU,IAAA,yKAAI,EAAC,YAAY,OAAO;AACpC;AAEO,MAAM,kBAAkB,IAAA,kKAAO,EAAC,oBAAoB;IACzD,IAAI,IAAA,+KAAO,EAAC,MAAM,UAAU,GAAG,OAAO,CAAC,qJAAG,CAAC,iBAAiB,CAAC;IAC7D,MAAM,IAAA,yKAAI,EAAC,QAAQ,OAAO;IAC1B,OAAO,IAAA,yKAAI,EAAC,SAAS,OAAO;IAC5B,SAAS,IAAA,yKAAI,EAAC;IACd,SAAS,IAAA,yKAAI,EAAC,WAAW,OAAO;IAChC,WAAW,IAAA,yKAAI,EAAC,cAAc,OAAO,CAAC,qJAAG,CAAC,iBAAiB,CAAC;AAC9D;AAEO,MAAM,WAAW,IAAA,kKAAO,EAAC,YAAY;IAC1C,IAAI,IAAA,+KAAO,EAAC,MAAM,UAAU,GAAG,OAAO,CAAC,qJAAG,CAAC,iBAAiB,CAAC;IAC7D,OAAO,IAAA,yKAAI,EAAC,SAAS,OAAO;IAC5B,aAAa,IAAA,yKAAI,EAAC,eAAe,OAAO;IACxC,UAAU,IAAA,yKAAI,EAAC,YAAY,OAAO;IAClC,UAAU,IAAA,yKAAI,EAAC,aAAa,OAAO;IACnC,MAAM,IAAA,yKAAI,EAAC;IACX,UAAU,IAAA,yKAAI,EAAC,YAAY,OAAO,CAAC;AACrC;AAEO,MAAM,WAAW,IAAA,kKAAO,EAAC,YAAY;IAC1C,IAAI,IAAA,+KAAO,EAAC,MAAM,UAAU,GAAG,OAAO,CAAC,qJAAG,CAAC,iBAAiB,CAAC;IAC7D,OAAO,IAAA,yKAAI,EAAC,UAAU,OAAO,GAAG,MAAM;IACtC,OAAO,IAAA,yKAAI,EAAC,SAAS,OAAO;IAC5B,QAAQ,IAAA,yKAAI,EAAC,UAAU,OAAO;IAC9B,UAAU,IAAA,yKAAI,EAAC,YAAY,OAAO;IAClC,QAAQ,IAAA,yKAAI,EAAC,UAAU,OAAO,GAAG,OAAO,CAAC;IACzC,MAAM,IAAA,yKAAI,EAAC;IACX,WAAW,IAAA,yKAAI,EAAC,cAAc,OAAO,CAAC,qJAAG,CAAC,iBAAiB,CAAC;AAC9D;AAEO,MAAM,mBAAmB,IAAA,gKAAkB,EAAC,OAAO,IAAI,CAAC;IAC7D,UAAU;IACV,UAAU;AACZ;AAEO,MAAM,sBAAsB,IAAA,gKAAkB,EAAC,iBAAiB,IAAI,CAAC;IAC1E,IAAI;IACJ,WAAW;AACb,GAAG,MAAM,CAAC;IACR,MAAM,yKAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACxB,OAAO,yKAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,SAAS,yKAAC,CAAC,MAAM,GAAG,GAAG,CAAC,IAAI;AAC9B;AAEO,MAAM,sBAAsB,IAAA,gKAAkB,EAAC,UAAU,IAAI,CAAC;IACnE,IAAI;AACN;AAWO,MAAM,sBAAsB,IAAA,gKAAkB,EAAC,UAAU,IAAI,CAAC;IACnE,IAAI;IACJ,WAAW;AACb"}},
    {"offset": {"line": 135, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Desktop/Work/veri-able/-vari-able-studio/lib/db.ts"],"sourcesContent":["import { drizzle } from 'drizzle-orm/neon-http';\r\nimport { neon } from '@neondatabase/serverless';\r\nimport * as schema from '@shared/schema';\r\n\r\nif (!process.env.DATABASE_URL) {\r\n    console.warn(\"DATABASE_URL is not set. Database features will not work.\");\r\n}\r\n\r\n// Validate that the URL is actually for Postgres/Neon before attempting connection\r\nconst isPostgres = process.env.DATABASE_URL && (process.env.DATABASE_URL.startsWith(\"postgres\") || process.env.DATABASE_URL.startsWith(\"neondb\"));\r\n\r\nif (process.env.DATABASE_URL && !isPostgres) {\r\n    console.warn(\"DATABASE_URL is set but does not look like a Postgres URL (e.g. MongoDB). Falling back to in-memory storage.\");\r\n}\r\n\r\nexport const db = isPostgres\r\n    ? drizzle(neon(process.env.DATABASE_URL!), { schema })\r\n    : null as any;\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEA,IAAI,CAAC,QAAQ,GAAG,CAAC,YAAY,EAAE;IAC3B,QAAQ,IAAI,CAAC;AACjB;AAEA,mFAAmF;AACnF,MAAM,aAAa,QAAQ,GAAG,CAAC,YAAY,IAAI,CAAC,QAAQ,GAAG,CAAC,YAAY,CAAC,UAAU,CAAC,eAAe,QAAQ,GAAG,CAAC,YAAY,CAAC,UAAU,CAAC,SAAS;AAEhJ,IAAI,QAAQ,GAAG,CAAC,YAAY,IAAI,CAAC,YAAY;IACzC,QAAQ,IAAI,CAAC;AACjB;AAEO,MAAM,KAAK,aACZ,IAAA,qKAAO,EAAC,IAAA,gKAAI,EAAC,QAAQ,GAAG,CAAC,YAAY,GAAI;IAAE,QAAA;AAAO,KAClD"}},
    {"offset": {"line": 160, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Desktop/Work/veri-able/-vari-able-studio/lib/storage.ts"],"sourcesContent":["import { users, contactRequests, projects, payments, type User, type InsertUser, type ContactRequest, type InsertContactRequest, type Project, type InsertProject, type Payment, type InsertPayment } from \"@shared/schema\";\r\nimport { randomUUID } from \"crypto\";\r\nimport { db } from \"./db\";\r\nimport { eq } from \"drizzle-orm\";\r\n\r\nexport interface IStorage {\r\n    getUser(id: string): Promise<User | undefined>;\r\n    getUserByUsername(username: string): Promise<User | undefined>;\r\n    createUser(user: InsertUser): Promise<User>;\r\n    createContactRequest(request: InsertContactRequest): Promise<ContactRequest>;\r\n    getProjects(): Promise<Project[]>;\r\n    createProject(project: InsertProject): Promise<Project>;\r\n    createPayment(payment: InsertPayment): Promise<Payment>;\r\n    getPaymentByTxRef(txRef: string): Promise<Payment | undefined>;\r\n    updatePaymentStatus(txRef: string, status: string, data?: string): Promise<Payment>;\r\n}\r\n\r\nexport class DatabaseStorage implements IStorage {\r\n    async getUser(id: string): Promise<User | undefined> {\r\n        const [user] = await db.select().from(users).where(eq(users.id, id));\r\n        return user;\r\n    }\r\n\r\n    async getUserByUsername(username: string): Promise<User | undefined> {\r\n        const [user] = await db.select().from(users).where(eq(users.username, username));\r\n        return user;\r\n    }\r\n\r\n    async createUser(insertUser: InsertUser): Promise<User> {\r\n        const [user] = await db.insert(users).values(insertUser).returning();\r\n        return user;\r\n    }\r\n\r\n    async createContactRequest(insertRequest: InsertContactRequest): Promise<ContactRequest> {\r\n        const [request] = await db.insert(contactRequests).values(insertRequest).returning();\r\n        return request;\r\n    }\r\n\r\n    async getProjects(): Promise<Project[]> {\r\n        const allProjects = await db.select().from(projects);\r\n        // In serverless/production, we assume seed data is managed via migration scripts or manually,\r\n        // but we can keep the \"empty check -> seed\" logic if desired, though it's risky in concurrent serverless envs.\r\n        // implementing a basic check.\r\n        if (allProjects.length === 0) {\r\n            const initialProjects: InsertProject[] = [\r\n                {\r\n                    title: \"TenantFlow — Landlord CRM template\",\r\n                    description: \"A vertical starter product for small landlords. Listings, tenant onboarding, rent collection, and basic analytics.\",\r\n                    category: \"Featured\",\r\n                    imageUrl: \"https://images.unsplash.com/photo-1620712943543-bcc4688e7485?q=80&w=2565&auto=format&fit=crop\",\r\n                    link: \"#\",\r\n                    featured: \"true\",\r\n                },\r\n                {\r\n                    title: \"XPlus Commerce\",\r\n                    description: \"A high-performance e-commerce platform built for the Nigerian market. Features real-time inventory, secure payments via Flutterwave, and a modular architecture for rapid scaling.\",\r\n                    category: \"E-commerce\",\r\n                    imageUrl: \"https://images.unsplash.com/photo-1563013544-824ae1b704d3?q=80&w=2670&auto=format&fit=crop\",\r\n                    link: \"https://xplus.com.ng\",\r\n                    featured: \"true\",\r\n                },\r\n                {\r\n                    title: \"Stripe Billing\",\r\n                    description: \"Customer portal, subscriptions.\",\r\n                    category: \"Integration\",\r\n                    imageUrl: \"https://images.unsplash.com/photo-1551288049-bebda4e38f71?q=80&w=2670&auto=format&fit=crop\",\r\n                    link: \"#\",\r\n                    featured: \"false\",\r\n                },\r\n                {\r\n                    title: \"Admin Panel\",\r\n                    description: \"Role management, user controls.\",\r\n                    category: \"Infrastructure\",\r\n                    imageUrl: \"https://images.unsplash.com/photo-1518432031352-d6fc5c10da5a?q=80&w=2574&auto=format&fit=crop\",\r\n                    link: \"#\",\r\n                    featured: \"false\",\r\n                }\r\n            ];\r\n\r\n            for (const p of initialProjects) {\r\n                // Use a try-catch for safety in case of parallel execution race conditions\r\n                try {\r\n                    await db.insert(projects).values(p);\r\n                } catch (e) {\r\n                    console.warn(\"Failed to seed project (might already exist):\", p.title);\r\n                }\r\n            }\r\n            return await db.select().from(projects);\r\n        }\r\n        return allProjects;\r\n    }\r\n\r\n    async createProject(insertProject: InsertProject): Promise<Project> {\r\n        const [project] = await db.insert(projects).values(insertProject).returning();\r\n        return project;\r\n    }\r\n\r\n    async createPayment(insertPayment: InsertPayment): Promise<Payment> {\r\n        const [payment] = await db.insert(payments).values(insertPayment).returning();\r\n        return payment;\r\n    }\r\n\r\n    async getPaymentByTxRef(txRef: string): Promise<Payment | undefined> {\r\n        const [payment] = await db.select().from(payments).where(eq(payments.txRef, txRef));\r\n        return payment;\r\n    }\r\n\r\n    async updatePaymentStatus(txRef: string, status: string, data?: string): Promise<Payment> {\r\n        const [payment] = await db.update(payments)\r\n            .set({ status, data })\r\n            .where(eq(payments.txRef, txRef))\r\n            .returning();\r\n        if (!payment) throw new Error(\"Payment not found\");\r\n        return payment;\r\n    }\r\n}\r\n\r\n// Fallback MemStorage for when DB is not available (dev only, explicit warning)\r\nexport class MemStorage implements IStorage {\r\n    private users: Map<string, User>;\r\n    private contactRequests: Map<string, ContactRequest>;\r\n    private projects: Map<string, Project>;\r\n    private payments: Map<string, Payment>;\r\n\r\n    constructor() {\r\n        this.users = new Map();\r\n        this.contactRequests = new Map();\r\n        this.projects = new Map();\r\n        this.payments = new Map();\r\n        // Seeding in constructor for MemStorage\r\n    }\r\n\r\n    async getUser(id: string): Promise<User | undefined> { return this.users.get(id); }\r\n    async getUserByUsername(username: string): Promise<User | undefined> {\r\n        return Array.from(this.users.values()).find(u => u.username === username);\r\n    }\r\n    async createUser(insertUser: InsertUser): Promise<User> {\r\n        const id = randomUUID();\r\n        const user = { ...insertUser, id };\r\n        this.users.set(id, user);\r\n        return user;\r\n    }\r\n    async createContactRequest(insertRequest: InsertContactRequest): Promise<ContactRequest> {\r\n        const id = randomUUID();\r\n        const req = { ...insertRequest, id, company: insertRequest.company ?? null, createdAt: new Date().toISOString() };\r\n        this.contactRequests.set(id, req);\r\n        return req;\r\n    }\r\n    async getProjects(): Promise<Project[]> { return Array.from(this.projects.values()); }\r\n    async createProject(insertProject: InsertProject): Promise<Project> {\r\n        const id = randomUUID();\r\n        const p = { ...insertProject, id, link: insertProject.link ?? null, featured: insertProject.featured ?? \"false\" };\r\n        this.projects.set(id, p);\r\n        return p;\r\n    }\r\n    async createPayment(insertPayment: InsertPayment): Promise<Payment> {\r\n        const id = randomUUID();\r\n        const p = { ...insertPayment, id, status: insertPayment.status ?? \"pending\", data: insertPayment.data ?? null, createdAt: new Date().toISOString() };\r\n        this.payments.set(id, p);\r\n        return p;\r\n    }\r\n    async getPaymentByTxRef(txRef: string): Promise<Payment | undefined> {\r\n        return Array.from(this.payments.values()).find(p => p.txRef === txRef);\r\n    }\r\n    async updatePaymentStatus(txRef: string, status: string, data?: string): Promise<Payment> {\r\n        const p = Array.from(this.payments.values()).find(x => x.txRef === txRef);\r\n        if (!p) throw new Error(\"Payment not found\");\r\n        p.status = status;\r\n        if (data) p.data = data;\r\n        return p;\r\n    }\r\n}\r\n\r\nexport const storage = process.env.DATABASE_URL ? new DatabaseStorage() : new MemStorage();\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 346, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Desktop/Work/veri-able/-vari-able-studio/lib/flutterwave.ts"],"sourcesContent":["/**\r\n * Flutterwave V3 API Integration (Standard)\r\n * Moved from server/flutterwave.ts\r\n */\r\n\r\nexport interface PaymentInitializationParams {\r\n    amount: number;\r\n    currency: string;\r\n    email: string;\r\n    tx_ref: string;\r\n    redirect_url: string;\r\n    customer_name?: string;\r\n    phone_number?: string;\r\n}\r\n\r\nexport async function initializePayment(params: PaymentInitializationParams) {\r\n    const FLW_SECRET_KEY = process.env.FLW_SECRET_KEY;\r\n    const API_BASE_URL = \"https://api.flutterwave.com/v3\";\r\n\r\n    console.log(\"[Flutterwave] Initializing payment:\", {\r\n        tx_ref: params.tx_ref,\r\n        amount: params.amount,\r\n        currency: params.currency,\r\n        email: params.email,\r\n        has_key: !!FLW_SECRET_KEY\r\n    });\r\n\r\n    if (!FLW_SECRET_KEY) {\r\n        throw new Error(\"Flutterwave Secret Key not configured. Set FLW_SECRET_KEY in .env\");\r\n    }\r\n\r\n    const payload = {\r\n        tx_ref: params.tx_ref,\r\n        amount: params.amount,\r\n        currency: params.currency,\r\n        redirect_url: params.redirect_url,\r\n        payment_options: \"card, account, banktransfer, ussd, mobilemoneygh, mobilemoneyfranco, mobilemoneyug, mobilemoneyrw, mobilemoneyzm, mobilemoneyks, barter, ozeemoney, payattitude, pwa, credit, 1ach, bank_transfer\",\r\n        customer: {\r\n            email: params.email,\r\n            name: params.customer_name || \"Customer\",\r\n            phone_number: params.phone_number || \"0000000000\",\r\n        },\r\n        customizations: {\r\n            title: \"veri—able studio\",\r\n            description: \"Project Reservation Deposit\",\r\n            logo: \"https://veriable.xyz/logo.png\"\r\n        },\r\n    };\r\n\r\n    console.log(\"[Flutterwave] Payment payload:\", JSON.stringify(payload, null, 2));\r\n\r\n    const response = await fetch(`${API_BASE_URL}/payments`, {\r\n        method: \"POST\",\r\n        headers: {\r\n            Authorization: `Bearer ${FLW_SECRET_KEY}`,\r\n            \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(payload),\r\n    });\r\n\r\n    const responseText = await response.text();\r\n    console.log(`[Flutterwave] Response Status: ${response.status}`);\r\n\r\n    if (!response.ok) {\r\n        let errorMessage = `Payment failed (${response.status})`;\r\n        try {\r\n            const errorData = JSON.parse(responseText);\r\n            errorMessage = errorData.message || JSON.stringify(errorData);\r\n        } catch {\r\n            errorMessage = responseText || errorMessage;\r\n        }\r\n        throw new Error(errorMessage);\r\n    }\r\n\r\n    let data;\r\n    try {\r\n        data = JSON.parse(responseText);\r\n    } catch {\r\n        throw new Error(`Invalid JSON response: ${responseText}`);\r\n    }\r\n\r\n    if (data.status !== \"success\") {\r\n        throw new Error(data.message || \"Payment initialization failed\");\r\n    }\r\n\r\n    return data;\r\n}\r\n\r\nexport async function verifyTransaction(transactionId: string) {\r\n    const FLW_SECRET_KEY = process.env.FLW_SECRET_KEY;\r\n    const API_BASE_URL = \"https://api.flutterwave.com/v3\";\r\n\r\n    if (!FLW_SECRET_KEY) {\r\n        throw new Error(\"Flutterwave Secret Key not configured.\");\r\n    }\r\n\r\n    const response = await fetch(`${API_BASE_URL}/transactions/${transactionId}/verify`, {\r\n        method: \"GET\",\r\n        headers: {\r\n            Authorization: `Bearer ${FLW_SECRET_KEY}`,\r\n            \"Content-Type\": \"application/json\",\r\n        },\r\n    });\r\n\r\n    const responseText = await response.text();\r\n\r\n    if (!response.ok) {\r\n        let errorMessage = `Verification failed (${response.status})`;\r\n        try {\r\n            const errorData = JSON.parse(responseText);\r\n            errorMessage = errorData.message || errorMessage;\r\n        } catch {\r\n            errorMessage = responseText || errorMessage;\r\n        }\r\n        throw new Error(errorMessage);\r\n    }\r\n\r\n    return JSON.parse(responseText);\r\n}\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;AAYM,eAAe,kBAAkB,MAAmC;IACvE,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc;IACjD,MAAM,eAAe;IAErB,QAAQ,GAAG,CAAC,uCAAuC;QAC/C,QAAQ,OAAO,MAAM;QACrB,QAAQ,OAAO,MAAM;QACrB,UAAU,OAAO,QAAQ;QACzB,OAAO,OAAO,KAAK;QACnB,SAAS,CAAC,CAAC;IACf;IAEA,IAAI,CAAC,gBAAgB;QACjB,MAAM,IAAI,MAAM;IACpB;IAEA,MAAM,UAAU;QACZ,QAAQ,OAAO,MAAM;QACrB,QAAQ,OAAO,MAAM;QACrB,UAAU,OAAO,QAAQ;QACzB,cAAc,OAAO,YAAY;QACjC,iBAAiB;QACjB,UAAU;YACN,OAAO,OAAO,KAAK;YACnB,MAAM,OAAO,aAAa,IAAI;YAC9B,cAAc,OAAO,YAAY,IAAI;QACzC;QACA,gBAAgB;YACZ,OAAO;YACP,aAAa;YACb,MAAM;QACV;IACJ;IAEA,QAAQ,GAAG,CAAC,kCAAkC,KAAK,SAAS,CAAC,SAAS,MAAM;IAE5E,MAAM,WAAW,MAAM,MAAM,GAAG,aAAa,SAAS,CAAC,EAAE;QACrD,QAAQ;QACR,SAAS;YACL,eAAe,CAAC,OAAO,EAAE,gBAAgB;YACzC,gBAAgB;QACpB;QACA,MAAM,KAAK,SAAS,CAAC;IACzB;IAEA,MAAM,eAAe,MAAM,SAAS,IAAI;IACxC,QAAQ,GAAG,CAAC,CAAC,+BAA+B,EAAE,SAAS,MAAM,EAAE;IAE/D,IAAI,CAAC,SAAS,EAAE,EAAE;QACd,IAAI,eAAe,CAAC,gBAAgB,EAAE,SAAS,MAAM,CAAC,CAAC,CAAC;QACxD,IAAI;YACA,MAAM,YAAY,KAAK,KAAK,CAAC;YAC7B,eAAe,UAAU,OAAO,IAAI,KAAK,SAAS,CAAC;QACvD,EAAE,OAAM;YACJ,eAAe,gBAAgB;QACnC;QACA,MAAM,IAAI,MAAM;IACpB;IAEA,IAAI;IACJ,IAAI;QACA,OAAO,KAAK,KAAK,CAAC;IACtB,EAAE,OAAM;QACJ,MAAM,IAAI,MAAM,CAAC,uBAAuB,EAAE,cAAc;IAC5D;IAEA,IAAI,KAAK,MAAM,KAAK,WAAW;QAC3B,MAAM,IAAI,MAAM,KAAK,OAAO,IAAI;IACpC;IAEA,OAAO;AACX;AAEO,eAAe,kBAAkB,aAAqB;IACzD,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc;IACjD,MAAM,eAAe;IAErB,IAAI,CAAC,gBAAgB;QACjB,MAAM,IAAI,MAAM;IACpB;IAEA,MAAM,WAAW,MAAM,MAAM,GAAG,aAAa,cAAc,EAAE,cAAc,OAAO,CAAC,EAAE;QACjF,QAAQ;QACR,SAAS;YACL,eAAe,CAAC,OAAO,EAAE,gBAAgB;YACzC,gBAAgB;QACpB;IACJ;IAEA,MAAM,eAAe,MAAM,SAAS,IAAI;IAExC,IAAI,CAAC,SAAS,EAAE,EAAE;QACd,IAAI,eAAe,CAAC,qBAAqB,EAAE,SAAS,MAAM,CAAC,CAAC,CAAC;QAC7D,IAAI;YACA,MAAM,YAAY,KAAK,KAAK,CAAC;YAC7B,eAAe,UAAU,OAAO,IAAI;QACxC,EAAE,OAAM;YACJ,eAAe,gBAAgB;QACnC;QACA,MAAM,IAAI,MAAM;IACpB;IAEA,OAAO,KAAK,KAAK,CAAC;AACtB"}},
    {"offset": {"line": 447, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Desktop/Work/veri-able/-vari-able-studio/app/api/payments/initialize/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { storage } from '@lib/storage';\r\nimport { initializePayment } from '@lib/flutterwave';\r\nimport crypto from \"crypto\";\r\n\r\nexport async function POST(req: Request) {\r\n    try {\r\n        const { email, amount, currency, name, description, packageName } = await req.json();\r\n\r\n        if (!email || !amount) {\r\n            return NextResponse.json({ message: \"Email and amount are required\" }, { status: 400 });\r\n        }\r\n\r\n        const tx_ref = `VS-${crypto.randomUUID()}`;\r\n        // Using simple environment variable or defaulting to URL origin if possible, strictly mostly ENV in serverless\r\n        const clientUrl = process.env.CLIENT_URL || process.env.VERCEL_URL ? `https://${process.env.VERCEL_URL}` : \"http://localhost:3000\";\r\n        // NOTE: dev is typically localhost:3000 in Next.js, but vite was 5173. \r\n        // We will run nextjs on 3000 usually. We need to check if user wants to keep 5173 or not. \r\n        // Next.js defaults to 3000. I'll stick to dynamic 3000 default or env.\r\n\r\n        const callback_url = `${clientUrl}/payment/callback`;\r\n\r\n        // Save to storage\r\n        await storage.createPayment({\r\n            txRef: tx_ref,\r\n            email,\r\n            amount: amount.toString(),\r\n            currency: currency || \"USD\",\r\n            status: \"pending\",\r\n            data: JSON.stringify({ name, description, packageName }),\r\n        });\r\n\r\n        const result = await initializePayment({\r\n            email,\r\n            amount,\r\n            currency: currency || \"NGN\",\r\n            tx_ref,\r\n            redirect_url: callback_url,\r\n            customer_name: name,\r\n        });\r\n\r\n        return NextResponse.json(result);\r\n    } catch (error: any) {\r\n        console.error(\"Payment initialization error:\", error);\r\n        return NextResponse.json({ message: error.message || \"Failed to initialize payment\" }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEO,eAAe,KAAK,GAAY;IACnC,IAAI;QACA,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,WAAW,EAAE,WAAW,EAAE,GAAG,MAAM,IAAI,IAAI;QAElF,IAAI,CAAC,SAAS,CAAC,QAAQ;YACnB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAgC,GAAG;gBAAE,QAAQ;YAAI;QACzF;QAEA,MAAM,SAAS,CAAC,GAAG,EAAE,gHAAM,CAAC,UAAU,IAAI;QAC1C,+GAA+G;QAC/G,MAAM,YAAY,QAAQ,GAAG,CAAC,UAAU,IAAI,QAAQ,GAAG,CAAC,UAAU,GAAG,CAAC,QAAQ,EAAE,QAAQ,GAAG,CAAC,UAAU,EAAE,GAAG;QAC3G,wEAAwE;QACxE,2FAA2F;QAC3F,uEAAuE;QAEvE,MAAM,eAAe,GAAG,UAAU,iBAAiB,CAAC;QAEpD,kBAAkB;QAClB,MAAM,2HAAO,CAAC,aAAa,CAAC;YACxB,OAAO;YACP;YACA,QAAQ,OAAO,QAAQ;YACvB,UAAU,YAAY;YACtB,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAM;gBAAa;YAAY;QAC1D;QAEA,MAAM,SAAS,MAAM,IAAA,yIAAiB,EAAC;YACnC;YACA;YACA,UAAU,YAAY;YACtB;YACA,cAAc;YACd,eAAe;QACnB;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,iCAAiC;QAC/C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS,MAAM,OAAO,IAAI;QAA+B,GAAG;YAAE,QAAQ;QAAI;IACzG;AACJ"}}]
}